sudo: required
language: python

services:
  - docker

install:
  - pip install ansible==2.6.4 docker-py==1.10.6 molecule==2.18.0

script:
  # TODO: molecule will only run ansible-lint on the target playbook,
  # we should run it on all once they're compliant
  - >
    cd ansible &&
    ansible-lint -v *.yml
    --exclude ./roles/kubernetes/
    --exclude ./vendor/
    --exclude ../kubespray/
    --exclude idr-kubernetes-apply.yml
    --exclude idr-reset-users-groups.yml
  - cd ansible; molecule test
