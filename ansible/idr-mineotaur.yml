# Setup IDR Mineotaur server
- hosts: "{{ idr_environment | default('idr') }}-a-dockermanager-hosts"

  tasks:

  - name: download mineotaur data
    become: yes
    synchronize:
      src: "rsync://{{ TBD_omero_host }}/mineotaur/"
      dest: "/tmp/mineotaur/"

  - name: change mineotaur to 1000 uid
    become: yes
    file:
      path: "/tmp/mineotaur"
      owner: 1000

  - name: enable mineotaur container
    docker_container:
      name: mineotaur
      image: imagedata/mineotaur
      entrypoint: java
      volumes:
        - /tmp/mineotaur:/mineotaur
      ports:
        - "8080:8080"
      command: ["-Xmx8g", "-Djava.security.egd=file:/dev/./urandom", "-jar", "/home/build/src/target/Mineotaur-1.0.1.jar", "-start", "/mineotaur"]
