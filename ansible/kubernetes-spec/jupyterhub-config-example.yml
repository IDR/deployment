---
apiVersion: v1
kind: ConfigMap
metadata:
  name: jupyterhub-config
  namespace: default
data:
  jupyterhub_config.py: |
    import os

    c.JupyterHub.spawner_class = 'kubespawner.KubeSpawner'
    c.JupyterHub.ip = '0.0.0.0'

    c.KubeSpawner.namespace = os.environ.get('POD_NAMESPACE', 'default')
    c.KubeSpawner.start_timeout = 60 * 5  # Upto 5 minutes, first pulls can be really slow
    c.KubeSpawner.singleuser_image_spec = 'imagedata/jupyter-docker:develop'
    c.KubeSpawner.singleuser_uid = 1000

    c.KubeSpawner.hub_connect_ip = os.environ['JUPYTERHUB_PROXY_SERVICE_HOST']
    c.KubeSpawner.hub_connect_port = int(os.environ['JUPYTERHUB_PROXY_SERVICE_PORT'])

    c.JupyterHub.authenticator_class = 'dummyauthenticator.DummyAuthenticator'
