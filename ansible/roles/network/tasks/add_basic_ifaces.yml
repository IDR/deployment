---
# Add new simple network interfaces
# This is intended to allow you to add an interface to a server without a
# full network restart.

- name: network | setup basic nics
  become: yes
  template:
    src: etc-sysconfig-network-scripts-ifcfg.j2
    dest: /etc/sysconfig/network-scripts/ifcfg-{{ item.device }}
  with_items: "{{ network_basic_ifaces | default([]) }}"
  register: network_ifaces_modified

- debug:
    msg: "{{ item }}"
  with_items:
  - "{{ network_ifaces_modified.results }}"

- name: network | restart modified nics
  become: yes
  shell: "/usr/sbin/ifdown {{ item.item.device }} && /usr/sbin/ifup {{ item.item.device }}"
  when: "{{ item | changed }}"
  with_items:
  - "{{ network_ifaces_modified.results }}"
