---
# defaults file for roles/nginx-proxy

# Number of worker processes, use auto to set this to the number of CPUs
nginx_proxy_worker_processes: 1

# Format for access.log, see templates/nginx-conf.j2 for predefined formats
nginx_proxy_log_format: main_timed_cache

# Enable SSL?
nginx_proxy_ssl: False

# Enable HTTP2 (ignore is nginx_proxy_ssl False)?
nginx_proxy_http2: False

# Redirect all http requests to https?
nginx_proxy_force_ssl: False

# Optional vars:

# Server path to SSL certificate
#nginx_proxy_ssl_certificate:

# Server path to SSL certificate key
#nginx_proxy_ssl_certificate_key:

# If defined the age to return in the Strict-Transport-Security header
# nginx_proxy_hsts_age:

# DNS servers for hostname lookups
#nginx_dynamic_proxy_resolvers:

# Number and size of proxy buffers
#nginx_proxy_buffers:

# List of dicts of backend servers
# To force dynamic DNS lookups need to use a variable:
# https://www.jethrocarr.com/2013/11/02/nginx-reverse-proxies-and-dns-resolution/
# http://forum.nginx.org/read.php?2,215830,215832#msg-215832
nginx_proxy_backends: []
#- name: test # Required if dynamic: True
#  location: /prefix
#  server: http://example.org
#  dynamic: False
#  cache_validity: 1d

# Caching parameters
nginx_proxy_cache_parent_path: /var/cache/nginx
nginx_proxy_caches: []
nginx_proxy_cache_skip: default
nginx_proxy_cache_match:
# Set to True to add X-Proxy-Cache* headers for debugging
nginx_proxy_debug_cache_headers: False

# Headers to be ignored, e.g. '"Set-Cookie" "Vary" "Expires"'
nginx_proxy_ignore_headers:

# EXPERIMENTAL: Example caching parameters for public OMERO
# nginx_proxy_cache_skip: "{{ nginx_proxy_cache_skip_omero }}"
# nginx_proxy_caches: "{{ nginx_proxy_caches_omero }}"
nginx_proxy_cache_match_omero: '"~web(client|gateway)/(metadata|render)_*"'
nginx_proxy_caches_omero:
- name: omero
  keysize: 500m
  inactive: 30d
  match: default
- name: omerorender
  keysize: 4000m
  inactive: 30d
  match: '"~web(client|gateway)/render_image/*"'
