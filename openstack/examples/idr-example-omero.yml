# Example playbook for installing OMERO.server into a VM

# Set hosts to all so this can be run locally, or pushed out to any testing VM.
# If you are going to use this as part of a production playbook you should
# change this to a host-group to avoid accidents.
- hosts: all

  pre_tasks:
  # This is needed for ansible to be run by cloud-init
  - lineinfile:
      backup: yes
      dest: /etc/sudoers
      regexp: "^Defaults\\s+requiretty"
      state: absent
      validate: "visudo -cf %s"
  roles:
  - role: upgrade-distpackages
  - role: samba-client
  - role: omero-server
  vars:
    postgresql_users_databases:
    - user: omero
      password: omero
      databases: [omero]
    omero_dbhost: localhost
    omero_dbuser: omero
    omero_dbname: omero
    omero_dbpassword: omero
    omero_datadir: /OMERO
    omero_selinux_setup: True
    omero_upgrade: True
    omero_release: 5.2.0
